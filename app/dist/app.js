var DataGrouper=function(){var has=function(obj,target){return _.any(obj,function(value){return _.isEqual(value,target)})},keys=function(data,names){return _.reduce(data,function(memo,item){var key=_.pick(item,names);return has(memo,key)||memo.push(key),memo},[])},group=function(data,names){var stems=keys(data,names);return _.map(stems,function(stem){return{key:stem,vals:_.map(_.where(data,stem),function(item){return _.omit(item,names)})}})};return group.register=function(name,converter){return group[name]=function(data,names){return _.map(group(data,names),converter)}},group}();DataGrouper.register("sum",function(item){return _.extend({},item.key,{Value:_.reduce(item.vals,function(memo,node){return memo+Number(node.Value)},0)})}),angular.module("beerTime",["firebase","ngRoute"]).config(function($routeProvider){$routeProvider.when("/",{templateUrl:"views/landingpage.html",controller:""}).when("/scoreboard",{templateUrl:"views/scoreboard.html",controller:"ScoreBoardCtrl"}).when("/beer",{templateUrl:"views/beers.html",controller:"BeerCtrl"}).otherwise({redirectTo:"/"})}),angular.module("beerTime").controller("BeerCtrl",["$scope","LoginService","$location","$firebaseArray",function($scope,LoginService,$location,$firebaseArray){var ref=new Firebase("https://beertime.firebaseio.com/data"),userObj=$firebaseArray(ref),auth=ref.getAuth();auth||$location.path("/"),$scope.addBeer=function(){if(!auth)return void logInPrompt();var user={userName:auth.google.displayName,id:auth.google.id};userObj.$add(user)}}]),angular.module("beerTime").controller("LoginCtrl",["$scope","LoginService","$location",function($scope,LoginService,$location){var ref=new Firebase("https://beertime.firebaseio.com/data");ref.getAuth()&&$location.path("scoreboard"),$scope.logIn=function(){LoginService.logInPrompt(ref)}}]),angular.module("beerTime").factory("LoginService",["$location",function($location){return{logInPrompt:function(ref){return ref.authWithOAuthPopup("google",function(error,authData){error?console.log("Login Failed!",error):console.log("login success")})}}}]),angular.module("beerTime").controller("ScoreBoardCtrl",["$scope","$firebaseArray","$location",function($scope,$firebaseArray,$location){var ref=new Firebase("https://beertime.firebaseio.com/data"),auth=ref.getAuth();auth||$location.path("/"),$scope.beers=$firebaseArray(ref)}]);